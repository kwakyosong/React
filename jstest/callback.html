<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <script>
        function sleep(callback) { 
            setTimeout(function() {
                callback();
            },1000);
        }
    </script>
</head>
<body>

    <script>
        // sleep(function() {
        //     console.log('a');
        //     sleep(function() { 
        //         console.log('b');
        //         sleep(function() { 
        //             console.log('c');
        //         })
        //     })
        // })
    </script>

    <script>
function buyAsync(mymoney) {
    return new Promise(function(resolve, reject) {
        setTimeout(function() {
            var payment= parseInt(prompt("지불하고자 하는 금액을 입력하십시오"));
            var balance = mymoney - payment;
            if( balance > 0 ) {
                console.log(`${payment}원을 지불했습니다. `);
                resolve(balance);
            } else {
                reject(`잔액은 ${mymoney}원 입니다. 구매할 수 없습니다`);
            }
        },3000);
    });
}
buyAsync(500)
    .then(function(balance) {
        console.log(`잔액은 ${balance}원 입니다. `);
        return buyAsync(balance);
    })
    .then(function(balance) {
        console.log(`잔액은 ${balance}원 입니다. `);
        return buyAsync(balance);
    })
    .then(function(balance) {
        console.log(`잔액은 ${balance}원 입니다. `);
        return buyAsync(balance);
    })
    .catch(function(error) {
        console.log(error);
    });

    </script>
</body>
</html>